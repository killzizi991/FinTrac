<!-- index.html -->
<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–§–∏–Ω–∞–Ω—Å–æ–≤—ã–π –∫–∞–ª–µ–Ω–¥–∞—Ä—å</title>
    <link rel="preload" href="./assets/fonts/msin.ttf" as="font" type="font/ttf" crossorigin>
    <link rel="preload" href="./assets/fonts/sab.ttf" as="font" type="font/ttf" crossorigin>
    <link rel="stylesheet" href="./assets/css/main.css">
    <link rel="stylesheet" href="./assets/css/calendar.css">
    <link rel="stylesheet" href="./assets/css/modals.css">
    <link rel="stylesheet" href="./assets/css/themes.css">
    <link rel="stylesheet" href="./assets/css/ui-components.css">
    <link rel="manifest" href="./manifest.json">
    <link rel="icon" type="image/png" href="./assets/icons/icon-72x72.png">
    <meta name="theme-color" content="#2563eb">
</head>
<body class="light-theme">
    <div class="app-container">
        <!-- –•–µ–¥–µ—Ä -->
        <header class="app-header">
            <div class="header-left">
                <h1 class="app-title">–§–∏–Ω–∞–Ω—Å–æ–≤—ã–π –∫–∞–ª–µ–Ω–¥–∞—Ä—å</h1>
                <div class="current-month-display">
                    <span id="current-month-year">–û–∫—Ç—è–±—Ä—å 2023</span>
                </div>
            </div>
            <div class="header-controls">
                <button id="prev-month" class="icon-button" aria-label="–ü—Ä–µ–¥—ã–¥—É—â–∏–π –º–µ—Å—è—Ü">‚Üê</button>
                <button id="next-month" class="icon-button" aria-label="–°–ª–µ–¥—É—é—â–∏–π –º–µ—Å—è—Ü">‚Üí</button>
                <button id="month-summary-btn" class="icon-button" aria-label="–ò—Ç–æ–≥–∏ –∑–∞ –º–µ—Å—è—Ü">üìä</button>
                <button id="categories-manager-btn" class="icon-button" aria-label="–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º–∏">üè∑Ô∏è</button>
                <button id="settings-btn" class="icon-button" aria-label="–ù–∞—Å—Ç—Ä–æ–π–∫–∏">‚öôÔ∏è</button>
                <button id="add-operation-btn" class="icon-button" aria-label="–î–æ–±–∞–≤–∏—Ç—å –æ–ø–µ—Ä–∞—Ü–∏—é">+</button>
            </div>
        </header>

        <!-- –û—Å–Ω–æ–≤–Ω–æ–π –∫–æ–Ω—Ç–µ–Ω—Ç -->
        <main class="main-content">
            <!-- –ö–∞–ª–µ–Ω–¥–∞—Ä—å -->
            <div class="calendar-section">
                <div class="calendar-header">
                    <div class="day-header">–ü–Ω</div>
                    <div class="day-header">–í—Ç</div>
                    <div class="day-header">–°—Ä</div>
                    <div class="day-header">–ß—Ç</div>
                    <div class="day-header">–ü—Ç</div>
                    <div class="day-header">–°–±</div>
                    <div class="day-header">–í—Å</div>
                </div>
                <div id="calendar-grid" class="calendar-grid">
                    <!-- –ö–∞–ª–µ–Ω–¥–∞—Ä—å –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç—Å—è JavaScript -->
                </div>
            </div>
        </main>

        <!-- –§—É—Ç–µ—Ä -->
        <footer class="app-footer">
            <div class="footer-info">
                <span id="storage-status" class="status-indicator">üü¢ –î–∞–Ω–Ω—ã–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã</span>
                <span id="offline-status" class="status-indicator">üü¢ –û–Ω–ª–∞–π–Ω</span>
            </div>
            <button id="install-btn" class="install-button" style="display: none;">
                –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
            </button>
        </footer>
    </div>

    <!-- –ú–æ–¥–∞–ª—å–Ω—ã–µ –æ–∫–Ω–∞ -->
    
    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –¥–Ω—è -->
    <div id="day-operations-modal" class="modal" data-modal-type="day-operations">
        <div class="modal-content">
            <div class="modal-header">
                <h2 id="modal-day-title">–û–ø–µ—Ä–∞—Ü–∏–∏ –∑–∞ 15.10.23</h2>
                <button class="modal-close">&times;</button>
            </div>
            <div class="modal-body">
                <div class="operations-sections">
                    <!-- –î–æ—Ö–æ–¥—ã -->
                    <section class="operations-section income-section">
                        <h3>–î–æ—Ö–æ–¥—ã</h3>
                        <div class="categories-list" id="income-categories">
                            <!-- –ö–∞—Ç–µ–≥–æ—Ä–∏–∏ –¥–æ—Ö–æ–¥–æ–≤ –≥–µ–Ω–µ—Ä–∏—Ä—É—é—Ç—Å—è JavaScript -->
                        </div>
                        <div class="operations-list" id="income-operations-list">
                            <!-- –°–ø–∏—Å–æ–∫ –æ–ø–µ—Ä–∞—Ü–∏–π –¥–æ—Ö–æ–¥–æ–≤ -->
                        </div>
                    </section>
                    
                    <!-- –†–∞—Å—Ö–æ–¥—ã -->
                    <section class="operations-section expense-section">
                        <h3>–†–∞—Å—Ö–æ–¥—ã</h3>
                        <div class="categories-list" id="expense-categories">
                            <!-- –ö–∞—Ç–µ–≥–æ—Ä–∏–∏ —Ä–∞—Å—Ö–æ–¥–æ–≤ –≥–µ–Ω–µ—Ä–∏—Ä—É—é—Ç—Å—è JavaScript -->
                        </div>
                        <div class="operations-list" id="expense-operations-list">
                            <!-- –°–ø–∏—Å–æ–∫ –æ–ø–µ—Ä–∞—Ü–∏–π —Ä–∞—Å—Ö–æ–¥–æ–≤ -->
                        </div>
                    </section>
                </div>
            </div>
        </div>
    </div>

    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –æ–ø–µ—Ä–∞—Ü–∏–∏ -->
    <div id="add-operation-modal" class="modal" data-modal-type="add-operation">
        <div class="modal-content">
            <div class="modal-header">
                <h2 id="add-operation-title">–î–æ–±–∞–≤–∏—Ç—å –æ–ø–µ—Ä–∞—Ü–∏—é</h2>
                <button class="modal-close">&times;</button>
            </div>
            <div class="modal-body">
                <form id="add-operation-form">
                    <div class="form-group">
                        <label for="operation-type">–¢–∏–ø –æ–ø–µ—Ä–∞—Ü–∏–∏</label>
                        <select id="operation-type" name="type" required>
                            <option value="">–í—ã–±–µ—Ä–∏—Ç–µ —Ç–∏–ø</option>
                            <option value="income">–î–æ—Ö–æ–¥</option>
                            <option value="expense">–†–∞—Å—Ö–æ–¥</option>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label for="operation-category">–ö–∞—Ç–µ–≥–æ—Ä–∏—è</label>
                        <select id="operation-category" name="category" required>
                            <option value="">–í—ã–±–µ—Ä–∏—Ç–µ –∫–∞—Ç–µ–≥–æ—Ä–∏—é</option>
                            <!-- –ö–∞—Ç–µ–≥–æ—Ä–∏–∏ –∑–∞–ø–æ–ª–Ω—è—é—Ç—Å—è JavaScript -->
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label for="operation-amount">–°—É–º–º–∞ (‚ÇΩ)</label>
                        <input type="number" id="operation-amount" name="amount" min="0" step="0.01" required>
                    </div>
                    
                    <div class="form-group">
                        <label for="operation-description">–û–ø–∏—Å–∞–Ω–∏–µ (–Ω–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ)</label>
                        <textarea id="operation-description" name="description" rows="3"></textarea>
                    </div>
                    
                    <div class="form-group">
                        <label for="operation-date">–î–∞—Ç–∞</label>
                        <input type="date" id="operation-date" name="date" required>
                    </div>
                    
                    <div class="form-actions">
                        <button type="submit" class="primary-button">–î–æ–±–∞–≤–∏—Ç—å</button>
                    </div>
                </form>
            </div>
        </div>
    </div>


    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º–∏ -->
    <div id="category-manager-modal" class="modal" data-modal-type="category-manager">
        <div class="modal-content">
            <div class="modal-header">
                <h2>–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º–∏</h2>
                <button class="modal-close">&times;</button>
            </div>
            <div class="modal-body">
                <div class="categories-manager">
                    <div class="categories-section">
                        <h3>–ö–∞—Ç–µ–≥–æ—Ä–∏–∏ –¥–æ—Ö–æ–¥—ã</h3>
                        <div class="categories-list" id="managed-income-categories">
                            <!-- –°–ø–∏—Å–æ–∫ –∫–∞—Ç–µ–≥–æ—Ä–∏–π –¥–æ—Ö–æ–¥–æ–≤ -->
                        </div>
                        <div class="add-category-form">
                            <input type="text" id="new-income-category" placeholder="–ù–æ–≤–∞—è –∫–∞—Ç–µ–≥–æ—Ä–∏—è –¥–æ—Ö–æ–¥–∞">
                            <button id="add-income-category" class="icon-button">+</button>
                        </div>
                    </div>
                    
                    <div class="categories-section">
                        <h3>–ö–∞—Ç–µ–≥–æ—Ä–∏–∏ —Ä–∞—Å—Ö–æ–¥—ã</h3>
                        <div class="categories-list" id="managed-expense-categories">
                            <!-- –°–ø–∏—Å–æ–∫ –∫–∞—Ç–µ–≥–æ—Ä–∏–π —Ä–∞—Å—Ö–æ–¥–æ–≤ -->
                        </div>
                        <div class="add-category-form">
                            <input type="text" id="new-expense-category" placeholder="–ù–æ–≤–∞—è –∫–∞—Ç–µ–≥–æ—Ä–∏—è —Ä–∞—Å—Ö–æ–¥–∞">
                            <button id="add-expense-category" class="icon-button">+</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –∏—Ç–æ–≥–æ–≤ –∑–∞ –º–µ—Å—è—Ü -->
    <div id="month-summary-modal" class="modal" data-modal-type="month-summary">
        <div class="modal-content">
            <div class="modal-header">
                <h2>–ò—Ç–æ–≥–∏ –∑–∞ –º–µ—Å—è—Ü</h2>
                <button class="modal-close">&times;</button>
            </div>
            <div class="modal-body">
                <div class="summary-card">
                    <div class="summary-item">
                        <span class="summary-label">–î–æ—Ö–æ–¥—ã:</span>
                        <span id="modal-total-income" class="summary-value income">0 ‚ÇΩ</span>
                    </div>
                    <div class="summary-item">
                        <span class="summary-label">–†–∞—Å—Ö–æ–¥—ã:</span>
                        <span id="modal-total-expense" class="summary-value expense">0 ‚ÇΩ</span>
                    </div>
                    <div class="summary-item total">
                        <span class="summary-label">–ë–∞–ª–∞–Ω—Å:</span>
                        <span id="modal-total-balance" class="summary-value balance">0 ‚ÇΩ</span>
                    </div>
                    <div class="summary-comparison">
                        <small id="modal-comparison-text">–°—Ä–∞–≤–Ω–µ–Ω–∏–µ —Å –ø—Ä–æ—à–ª—ã–º –º–µ—Å—è—Ü–µ–º</small>
                    </div>
                </div>
                
                <!-- –ù–æ–≤—ã–π –±–ª–æ–∫: –æ—Ç—á–µ—Ç –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º -->
                <div class="category-report-section">
                    <h3>–û—Ç—á–µ—Ç –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º</h3>
                    <div class="category-report-content">
                        <div class="category-report-column">
                            <h4>–î–æ—Ö–æ–¥—ã</h4>
                            <div id="modal-income-categories-report" class="categories-report-list">
                                <!-- –ö–∞—Ç–µ–≥–æ—Ä–∏–∏ –¥–æ—Ö–æ–¥–æ–≤ —Å —Å—É–º–º–∞–º–∏ –±—É–¥—É—Ç –∑–¥–µ—Å—å -->
                            </div>
                        </div>
                        <div class="category-report-column">
                            <h4>–†–∞—Å—Ö–æ–¥—ã</h4>
                            <div id="modal-expense-categories-report" class="categories-report-list">
                                <!-- –ö–∞—Ç–µ–≥–æ—Ä–∏–∏ —Ä–∞—Å—Ö–æ–¥–æ–≤ —Å —Å—É–º–º–∞–º–∏ –±—É–¥—É—Ç –∑–¥–µ—Å—å -->
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –Ω–∞—Å—Ç—Ä–æ–µ–∫ -->
    <div id="settings-modal" class="modal" data-modal-type="settings">
        <div class="modal-content">
            <div class="modal-header">
                <h2>–ù–∞—Å—Ç—Ä–æ–π–∫–∏</h2>
                <button class="modal-close">&times;</button>
            </div>
            <div class="modal-body">
                <div class="settings-section">
                    <h3>–í–Ω–µ—à–Ω–∏–π –≤–∏–¥</h3>
                    <button id="modal-theme-switcher" class="primary-button" style="width: 100%; margin-bottom: 15px;">
                        –ü–µ—Ä–µ–∫–ª—é—á–∏—Ç—å —Ç–µ–º—É
                    </button>
                </div>
                
                <div class="settings-section">
                    <h3>–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã–º–∏</h3>
                    <div class="settings-actions">
                        <button id="modal-export-import-btn" class="primary-button" style="width: 100%; margin-bottom: 10px;">
                            –≠–∫—Å–ø–æ—Ä—Ç / –ò–º–ø–æ—Ä—Ç –¥–∞–Ω–Ω—ã—Ö
                        </button>
                        <button id="modal-clear-data-btn" class="secondary-button" style="width: 100%;">
                            –û—á–∏—Å—Ç–∏—Ç—å –≤—Å–µ –¥–∞–Ω–Ω—ã–µ
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –æ—Ç—á–µ—Ç–æ–≤ -->
    <div id="report-modal" class="modal" data-modal-type="report">
        <div class="modal-content">
            <div class="modal-header">
                <h2>–û—Ç—á–µ—Ç –∑–∞ –º–µ—Å—è—Ü</h2>
                <button class="modal-close">&times;</button>
            </div>
            <div class="modal-body">
                <div class="report-content">
                    <div class="report-summary">
                        <div class="report-item">
                            <span>–û–±—â–∏–π –¥–æ—Ö–æ–¥:</span>
                            <span id="report-total-income" class="income">0 ‚ÇΩ</span>
                        </div>
                        <div class="report-item">
                            <span>–û–±—â–∏–π —Ä–∞—Å—Ö–æ–¥:</span>
                            <span id="report-total-expense" class="expense">0 ‚ÇΩ</span>
                        </div>
                        <div class="report-item total">
                            <span>–ë–∞–ª–∞–Ω—Å:</span>
                            <span id="report-balance" class="balance">0 ‚ÇΩ</span>
                        </div>
                        <div class="report-comparison">
                            <h4>–°—Ä–∞–≤–Ω–µ–Ω–∏–µ —Å –ø—Ä–µ–¥—ã–¥—É—â–∏–º –º–µ—Å—è—Ü–µ–º</h4>
                            <div id="comparison-details">
                                <!-- –î–∞–Ω–Ω—ã–µ —Å—Ä–∞–≤–Ω–µ–Ω–∏—è -->
                            </div>
                        </div>
                    </div>
                    
                    <div class="report-categories">
                        <h3>–ö–∞—Ç–µ–≥–æ—Ä–∏–∏ –¥–æ—Ö–æ–¥—ã</h3>
                        <div id="income-categories-report">
                            <!-- –û—Ç—á–µ—Ç –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º –¥–æ—Ö–æ–¥–æ–≤ -->
                        </div>
                        
                        <h3>–ö–∞—Ç–µ–≥–æ—Ä–∏–∏ —Ä–∞—Å—Ö–æ–¥—ã</h3>
                        <div id="expense-categories-report">
                            <!-- –û—Ç—á–µ—Ç –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º —Ä–∞—Å—Ö–æ–¥–æ–≤ -->
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ —ç–∫—Å–ø–æ—Ä—Ç–∞/–∏–º–ø–æ—Ä—Ç–∞ -->
    <div id="export-import-modal" class="modal" data-modal-type="export-import">
        <div class="modal-content">
            <div class="modal-header">
                <h2>–≠–∫—Å–ø–æ—Ä—Ç / –ò–º–ø–æ—Ä—Ç –¥–∞–Ω–Ω—ã—Ö</h2>
                <button class="modal-close">&times;</button>
            </div>
            <div class="modal-body">
                <div class="export-import-section">
                    <h3>–≠–∫—Å–ø–æ—Ä—Ç –¥–∞–Ω–Ω—ã—Ö</h3>
                    <div class="export-actions">
                        <button id="export-download-btn" class="primary-button">–°–∫–∞—á–∞—Ç—å JSON</button>
                        <button id="export-copy-btn" class="secondary-button">–ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å JSON</button>
                    </div>
                    <div class="json-preview">
                        <textarea id="export-json-text" readonly rows="8"></textarea>
                    </div>
                </div>
                
                <div class="export-import-section">
                    <h3>–ò–º–ø–æ—Ä—Ç –¥–∞–Ω–Ω—ã—Ö</h3>
                    <div class="import-actions">
                        <label for="import-file" class="file-input-label">
                            <span>–ó–∞–≥—Ä—É–∑–∏—Ç—å —Ñ–∞–π–ª JSON</span>
                            <input type="file" id="import-file" accept=".json" style="display: none;">
                        </label>
                        <button id="import-paste-btn" class="secondary-button">–í—Å—Ç–∞–≤–∏—Ç—å –∏–∑ –±—É—Ñ–µ—Ä–∞</button>
                    </div>
                    <div class="json-input">
                        <textarea id="import-json-text" placeholder="–í—Å—Ç–∞–≤—å—Ç–µ JSON –¥–∞–Ω–Ω—ã–µ..." rows="6"></textarea>
                    </div>
                    <div class="import-warning">
                        <small>‚ö†Ô∏è –í–Ω–∏–º–∞–Ω–∏–µ: –∏–º–ø–æ—Ä—Ç –ø–æ–ª–Ω–æ—Å—Ç—å—é –∑–∞–º–µ–Ω–∏—Ç —Ç–µ–∫—É—â–∏–µ –¥–∞–Ω–Ω—ã–µ</small>
                    </div>
                    <button id="import-execute-btn" class="primary-button" disabled>–ò–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –¥–∞–Ω–Ω—ã–µ</button>
                </div>
            </div>
        </div>
    </div>

    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è -->
    <div id="confirm-modal" class="modal" data-modal-type="confirm">
        <div class="modal-content">
            <div class="modal-header">
                <h2 id="confirm-title">–ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ</h2>
                <button class="modal-close">&times;</button>
            </div>
            <div class="modal-body">
                <p id="confirm-message">–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ –≤—ã–ø–æ–ª–Ω–∏—Ç—å —ç—Ç–æ –¥–µ–π—Å—Ç–≤–∏–µ?</p>
                <div class="modal-actions">
                    <button id="confirm-cancel" class="secondary-button">–û—Ç–º–µ–Ω–∞</button>
                    <button id="confirm-ok" class="primary-button">–ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç—å</button>
                </div>
            </div>
        </div>
    </div>

    <!-- –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è -->
    <div id="notification-container" class="notification-container"></div>

    <!-- –°–∫—Ä–∏–ø—Ç—ã -->
    <script src="./assets/js/core/constants.js"></script>
    <script src="./assets/js/core/utils.js"></script>
    <script src="./assets/js/core/state.js"></script>
    <script src="./assets/js/ui/modal-manager.js"></script>
    <script src="./assets/js/ui/theme-switcher.js"></script>
    <script src="./assets/js/ui/notifications.js"></script>
    <script src="./assets/js/ui/header-controls.js"></script>
    <script src="./assets/js/modules/data-manager.js"></script>
    <script src="./assets/js/modules/calendar.js"></script>
    <script src="./assets/js/modules/operations.js"></script>
    <script src="./assets/js/modules/categories.js"></script>
    <script src="./assets/js/modules/reports.js"></script>
    <script src="./assets/js/modules/export-import.js"></script>
    <script src="./assets/js/pwa/sw-register.js"></script>
    <script src="./assets/js/pwa/offline-handler.js"></script>
    <script src="./assets/js/core/app.js"></script>
</body>
</html>
